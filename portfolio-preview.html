<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ë‚´ í¬íŠ¸í´ë¦¬ì˜¤</title>
  <link rel="stylesheet" href="/main.css?v=1.06" />
  <link rel="stylesheet" href="/portfolio-preview.css?v=1.0" />
</head>
<body>
  <!-- âœ… ê³µí†µ í—¤ë” -->
  <div id="header-container"></div>
  <nav class="top-tabs" id="top-tab-container"></nav>

  <main class="portfolio-preview">
    <h2>ë‚´ í¬íŠ¸í´ë¦¬ì˜¤</h2>
    <div id="portfolioContent">
      <p>ë¡œë”© ì¤‘ì…ë‹ˆë‹¤...</p>
    </div>
  </main>

  <!-- âœ… ê³µí†µ í•˜ë‹¨íƒ­ -->
  <nav class="bottom-tab" id="bottom-tab-container"></nav>

  <script src="/js/header.js"></script>
  <script src="/js/top-tab.js"></script>
  <script src="/js/bottom-tab.js"></script>

  <script>
    document.addEventListener('DOMContentLoaded', async () => {
      const portfolioContent = document.getElementById('portfolioContent');
      const token = localStorage.getItem('liveeToken');

      if (!token) {
        portfolioContent.innerHTML = `
          <p>ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.</p>
          <button onclick="location.href='/login.html'">ë¡œê·¸ì¸í•˜ëŸ¬ ê°€ê¸°</button>
        `;
        return;
      }

      try {
        const res = await fetch('https://livee-server-dev.onrender.com/portfolio/mine', {
          headers: {
            Authorization: `Bearer ${token}`,
          },
        });

        if (!res.ok) {
          const errText = await res.text();
          throw new Error(errText || 'ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨');
        }

        const data = await res.json();

        if (!data || !data._id) {
          portfolioContent.innerHTML = `
            <p>ì‘ì„±ëœ í¬íŠ¸í´ë¦¬ì˜¤ê°€ ì—†ìŠµë‹ˆë‹¤.</p>
            <button onclick="location.href='/portfolio-edit.html'">+ í¬íŠ¸í´ë¦¬ì˜¤ ë“±ë¡</button>
          `;
          return;
        }

        portfolioContent.innerHTML = `
          <div class="portfolio-card">
            <img src="${data.photoUrl || '/default-profile.png'}" alt="í”„ë¡œí•„ ì´ë¯¸ì§€" class="portfolio-photo" />
            <h3>${data.title}</h3>
            <p><strong>ì´ë¦„:</strong> ${data.name}</p>
            <p><strong>ê²½ë ¥:</strong> ${data.career}</p>
            <p><strong>í™œë™:</strong> ${data.activity}</p>
            <p><strong>ì„±ê²©:</strong> ${data.character}</p>
            <p><strong>í¬ë§ ì¶œì—°ë£Œ:</strong> ${data.fee}</p>
            <p><strong>ì¶œì—° ì¡°ê±´:</strong> ${data.condition}</p>
            <p><strong>ì¹´í…Œê³ ë¦¬:</strong> ${data.category}</p>
            <button onclick="location.href='/portfolio-edit.html?id=${data._id}'">ìˆ˜ì •í•˜ê¸°</button>
          </div>
        `;
      } catch (err) {
        console.error('âŒ í¬íŠ¸í´ë¦¬ì˜¤ ë¶ˆëŸ¬ì˜¤ê¸° ì˜¤ë¥˜:', err);
        portfolioContent.innerHTML = `<p>í¬íŠ¸í´ë¦¬ì˜¤ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆì–´ìš”. ğŸ˜¢</p>`;
      }
    });
  </script>
</body>
</html>