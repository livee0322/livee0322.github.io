<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Livee 쇼핑라이브 공고 리스트</title>
  <link rel="stylesheet" href="/main.css?v=1.04" />
  <link rel="stylesheet" href="/recruitlist.css?v=1.01" />
  <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet" />
</head>
<body>

  <!-- ✅ 베타 배너 -->
  <div class="beta-banner">현재 클로즈 베타 테스트 중입니다. 피드백을 환영합니다!</div>

  <!-- ✅ 공통 헤더 -->
  <div id="header-container"></div>

  <!-- ✅ 공통 상단탭 -->
  <div id="top-tab-container"></div>

  <!-- ✅ 카테고리 필터 -->
  <div class="category-scroll">
    <button class="active">전체</button>
    <button>패션</button>
    <button>뷰티</button>
    <button>푸드</button>
    <button>생활</button>
    <button>기타</button>
  </div>

  <!-- ✅ 공고 리스트 -->
  <section id="recruit-list" class="recruit-list"></section>

  <!-- ✅ 등록 FAB 버튼 -->
  <button class="fab" onclick="handleFabClick()">+</button>

  <!-- ✅ 공통 하단탭 -->
  <div id="bottom-tab-container"></div>

  <!-- ✅ 공통 JS -->
  <script defer src="/js/header.js"></script>
  <script defer src="/js/top-tab.js"></script>
  <script defer src="/js/bottom-tab.js"></script>

  <!-- ✅ 공고 렌더링 스크립트 -->
  <script>
    function handleMyPage() {
      const user = localStorage.getItem("loginUser");
      location.href = user ? "/mypage.html" : "/login.html";
    }

    function handleFabClick() {
      const user = localStorage.getItem("loginUser");
      if (!user) {
        alert("로그인이 필요합니다.");
        location.href = "/login.html";
        return;
      }
      location.href = "/recruitform.html";
    }

    function renderPosts() {
      const container = document.getElementById("recruit-list");
      const posts = JSON.parse(localStorage.getItem("recruitPosts") || "[]");

      if (posts.length === 0) {
        container.innerHTML = "<p class='empty'>등록된 공고가 없습니다.</p>";
        return;
      }

      container.innerHTML = posts
        .map((post) => {
          const date = new Date(post.datetime);
          const dateText = isNaN(date.getTime())
            ? "방송일 미정"
            : date.toLocaleString("ko-KR", {
                year: "numeric",
                month: "long",
                day: "numeric",
                hour: "2-digit",
                minute: "2-digit",
              });

          return `
            <div class="recruit-card">
              <img src="${post.imageUrl}" alt="${post.title}" />
              <h3>${post.title}</h3>
              <p>${post.brand}</p>
              <small>${dateText}</small>
              <a href="${post.link}" target="_blank">지원하기</a>
            </div>
          `;
        })
        .join("");
    }

    renderPosts();
  </script>
</body>
</html>