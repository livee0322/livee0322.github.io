<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>포트폴리오 상세</title>
  <link rel="stylesheet" href="/main.css?v=1.06" />
  <link rel="stylesheet" href="/portfolio.css?v=1.60" />
</head>
<body>

  <!-- ✅ 공통 헤더 -->
  <div id="header-container"></div>
  <div id="top-tab-container"></div>

  <main class="portfolio-wrapper">
    <div id="portfolioDetail">
      <p>불러오는 중...</p>
    </div>
  </main>

  <div id="bottom-tab-container"></div>

  <!-- ✅ 공통 JS -->
  <script src="/js/header.js"></script>
  <script src="/js/top-tab.js"></script>
  <script src="/js/bottom-tab.js"></script>

  <!-- ✅ 상세 데이터 불러오기 -->
  <script>
    document.addEventListener('DOMContentLoaded', async () => {
      const params = new URLSearchParams(window.location.search);
      const id = params.get('id');
      const container = document.getElementById('portfolioDetail');
      const token = localStorage.getItem('liveeToken');

      if (!token) {
        container.innerHTML = '<p>로그인이 필요합니다.</p>';
        return;
      }

      if (!id) {
        container.innerHTML = '<p>잘못된 접근입니다. 포트폴리오 ID가 없습니다.</p>';
        return;
      }

      try {
        const res = await fetch(`https://livee-server-dev.onrender.com/portfolio/${id}`, {
          headers: {
            Authorization: `Bearer ${token}`
          }
        });

        if (!res.ok) throw new Error('데이터 불러오기 실패');

        const data = await res.json();

        container.innerHTML = `
          <div class="portfolio-card">
            <img src="${data.photo || '/default-profile.png'}" alt="프로필 이미지" />
            <h3>${data.title}</h3>
            <p><strong>이름:</strong> ${data.name}</p>
            <p><strong>경력:</strong> ${data.career}</p>
            <p><strong>활동:</strong> ${data.activity}</p>
            <p><strong>성격:</strong> ${data.character}</p>
            <p><strong>출연료:</strong> ${data.fee}</p>
            <p><strong>조건:</strong> ${data.condition}</p>
            <p><strong>카테고리:</strong> ${data.category}</p>
            <button onclick="location.href='/portfolio-edit.html?id=${data._id}'">수정하기</button>
          </div>
        `;
      } catch (err) {
        console.error(err);
        container.innerHTML = '<p>포트폴리오 정보를 불러오는 데 실패했습니다.</p>';
      }
    });
  </script>
</body>
</html>