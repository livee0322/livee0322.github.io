<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>마이페이지 - Livee</title>
  <link href="https://cdn.jsdelivr.net/npm/remixicon@4.1.0/fonts/remixicon.css" rel="stylesheet" />
  <link rel="stylesheet" href="/main.css?v=1.04" />
</head>
<body>

  <!-- 상단 헤더 -->
  <header class="header">
    <div class="logo">Livee</div>
    <div class="right-icons">
      <span id="userEmail" style="font-size: 0.9rem; margin-right: 10px;"></span>
      <button id="logoutBtn" style="display: none; background: none; border: none; color: #6A4DF4; cursor: pointer;">로그아웃</button>
      <i class="ri-search-line"></i>
      <i class="ri-notification-3-line"></i>
    </div>
  </header>

  <!-- 상단 탭 -->
  <nav class="top-tabs">
    <a href="/index.html">홈</a>
    <a href="/clip.html">숏클립</a>
    <a href="/event.html">이벤트</a>
    <a href="/live.html">라이브</a>
    <a href="/influencer.html">인플루언서</a>
    <a href="/agency.html">대행서비스</a>
    <a href="/news.html">뉴스</a>
  </nav>

  <!-- 마이페이지 본문 -->
  <main style="padding: 20px 16px 100px; background: #f9f9fb;">
    <h2 style="font-size: 1.2rem; margin-bottom: 20px;">마이페이지</h2>

    <a href="/change-password.html" class="mypage-item">
      <span>비밀번호 변경</span>
      <i class="ri-arrow-right-s-line"></i>
    </a>

    <a href="/myportfolio.html" class="mypage-item">
      <span>내 포트폴리오</span>
      <i class="ri-arrow-right-s-line"></i>
    </a>

    <a href="/my-luvies.html" class="mypage-item">
      <span>보유 러비</span>
      <i class="ri-arrow-right-s-line"></i>
    </a>

    <a href="/applied-jobs.html" class="mypage-item">
      <span>내가 지원한 공고</span>
      <i class="ri-arrow-right-s-line"></i>
    </a>

    <a href="/wishlist.html" class="mypage-item">
      <span>찜한 공고</span>
      <i class="ri-arrow-right-s-line"></i>
    </a>

    <a href="/my-benefits.html" class="mypage-item">
      <span>받은 혜택 / 이벤트</span>
      <i class="ri-arrow-right-s-line"></i>
    </a>

    <a href="/suggestions.html" class="mypage-item">
      <span>나에게 온 제안</span>
      <i class="ri-arrow-right-s-line"></i>
    </a>
  </main>

  <!-- 하단탭 -->
  <nav class="bottom-tab">
    <a href="/index.html"><i class="ri-home-line"></i><div>홈</div></a>
    <a href="/recruitlist.html"><i class="ri-live-line"></i><div>라이브</div></a>
    <a href="/portfolio.html"><i class="ri-briefcase-line"></i><div>쇼호스트</div></a>
    <a href="/liveschedule.html"><i class="ri-calendar-line"></i><div>일정</div></a>
    <a href="/mypage.html" class="active"><i class="ri-user-3-line"></i><div>마이</div></a>
  </nav>

  <!-- ✅ 스타일 -->
  <style>
    .mypage-item {
      background: #fff;
      padding: 16px;
      margin-bottom: 10px;
      border-radius: 12px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 1rem;
      box-shadow: 0 1px 4px rgba(0,0,0,0.05);
      text-decoration: none;
      color: #222;
    }
    .mypage-item i {
      font-size: 1.2rem;
      color: #999;
    }
    .mypage-item:hover {
      background: #f1efff;
    }
  </style>

  <!-- ✅ 로그인 상태 확인 및 로그아웃 -->
  <script>
    window.onload = async function () {
      const token = localStorage.getItem("liveeToken");
      const userEmail = document.getElementById("userEmail");
      const logoutBtn = document.getElementById("logoutBtn");

      if (!token) {
        alert("로그인이 필요합니다.");
        window.location.href = "/login.html";
        return;
      }

      try {
        const res = await fetch("https://livee-server-dev.onrender.com/profile", {
          headers: { Authorization: `Bearer ${token}` }
        });

        if (res.ok) {
          const data = await res.json();
          userEmail.textContent = `${data.email}님`;
          logoutBtn.style.display = "inline";
        } else {
          localStorage.removeItem("liveeToken");
          alert("로그인 정보가 만료되었습니다.");
          window.location.href = "/login.html";
        }
      } catch (e) {
        alert("서버 오류로 로그인 확인 실패");
      }

      logoutBtn.onclick = () => {
        localStorage.removeItem("liveeToken");
        alert("로그아웃 되었습니다.");
        window.location.href = "/login.html";
      };
    };
  </script>

</body>
</html>